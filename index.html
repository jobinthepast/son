<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Schedule</title>

<style>
  body { background:#fff; font-family:Arial; }
  table { border-collapse:collapse; margin:20px auto; }
  th,td { border:1px solid #555; padding:6px; text-align:center; }

  th { background:#bfbfbf; font-weight:bold; }
  .time { background:#c9c9c9; font-weight:bold; width:80px; }

  .gray{background:#e0e0e0;color:#999}
  .red{background:#ff0000;color:#fff;font-weight:bold}
  .blue{background:#0022ff;color:#fff;font-weight:bold}
  .black{background:#000;color:#fff;font-weight:bold}
  .green{background:#55ff00;color:#000;font-weight:bold}
  .dodgerblue{background:#1e90ff;color:#fff;font-weight:bold}

  .day-highlight{background:yellow!important}
  .time-highlight{background:yellow!important}

  .blink{
    animation:blink 1s infinite;
  }
  @keyframes blink{
    0%{outline:3px solid #fff700}
    50%{outline:3px solid transparent}
    100%{outline:3px solid #fff700}
  }

  .study-box {
    /* border: 1px solid #ccc; */
    border: none;
    padding: 12px;
    background: #fff;
    width: fit-content;
    margin-top: 16px;
  }

  .study-item {
    margin: 6px 0;
    text-align: left;
  }

  #newWeekBtn {
    margin-top: 12px;
    padding: 6px 12px;
    cursor: pointer;
  }

  .confetti {
    position: fixed;
    width: 8px;
    height: 8px;
    top: -10px;
    animation: fall linear forwards;
    z-index: 9999;
  }

  @keyframes fall {
    to {
      transform: translateY(110vh) rotate(720deg);
      opacity: 0;
    }
  }
</style>
</head>

<body>
<table id="tbl">
<tr>
  <th></th>
  <th data-day="1">Mon</th>
  <th data-day="2">Tue</th>
  <th data-day="3">Wed</th>
  <th data-day="4">Thu</th>
  <th data-day="5">Fri</th>
  <th data-day="6">Sat</th>
  <th data-day="0">Sun</th>
</tr>

<tr data-time="06:15">
<td class="time">6:15</td>
<td data-day="1" class="gray">wake up</td>
<td data-day="2" class="gray">wake up</td>
<td data-day="3" class="gray">wake up</td>
<td data-day="4" class="gray">wake up</td>
<td data-day="5" class="gray">wake up</td>
<td data-day="6" class="gray"></td>
<td data-day="0" class="gray"></td>
</tr>

<tr data-time="07:00">
<td class="time">7:00</td>
<td data-day="1" class="gray">to school</td>
<td data-day="2" class="gray">to school</td>
<td data-day="3" class="gray">to school</td>
<td data-day="4" class="gray">to school</td>
<td data-day="5" class="gray">to school</td>
<td data-day="6" class="gray"></td>
<td data-day="0" class="gray"></td>
</tr>

<tr data-time="08:00">
<td class="time">8:00</td>
<td colspan="5" data-days="1,2,3,4,5" rowspan="4" data-start="08:00" data-end="16:00" class="gray">
- chú ý nghe giảng, hiểu bài nhớ bài tại lớp<br>
- soạn bài ngày hôm sau tại lớp
</td>
<td data-day="6" class="gray">c.Thanh</td>
<td data-day="0" class="gray"></td>
</tr>

<tr data-time="10:00">
<td class="time">10:00</td>
<td data-day="6" class="gray"></td>
<td data-day="0" class="gray">c.Lan</td>
</tr>

<tr data-time="14:30">
<td class="time">14:30</td>
<td data-day="6" class="blue">swim</td>
<td data-day="7" class="dodgerblue">(swim)</td>
</tr>

<tr data-time="16:00">
<td class="time">16:00</td>
<td data-day="6" class="green">football</td>
<td data-day="0" class="gray" rowspan="11" data-start="16:00" data-end="22:00">
  <div class="study-box" data-box-id="study0" style="background-color:#e0e0e0">
    <div class="study-item">
      <input type="checkbox" id="math-0">
      <label for="math-0">Tưới cây</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="math-0">
      <label for="math-0">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-0">
      <label for="vietnamese-0">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-0">
      <label for="english-0">Đọc TV x2</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-0">
      <label for="cothanh-0">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-0">
      <label for="colan-0">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-0">
      <label for="daddy-0">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-0">
      <label for="quanao-0">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-0">
      <label for="donbanhoc-0">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-0">
      <label for="sapsachvo-0">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-0">
      <label for="sapquanao-0">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-0">
      <label for="danhrang-0">Đánh răng</label>
    </div>
  </div>
</td>
</tr>

<tr data-time="16:40">
<td class="time">16:40</td>
<td data-day="1" class="gray">eat</td>
<td data-day="2" class="gray">eat</td>
<td data-day="3" class="gray">eat</td>
<td data-day="4" class="gray">eat</td>
<td data-day="5" class="gray">eat</td>
<td data-day="6" class="gray" rowspan="10" data-start="16:40" data-end="22:00">
  <div class="study-box" data-box-id="study6" style="background-color:#e0e0e0">
    <div class="study-item">
      <input type="checkbox" id="math-6">
      <label for="math-6">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-6">
      <label for="vietnamese-6">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-6">
      <label for="english-6">Đọc TV x2</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-6">
      <label for="cothanh-6">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-6">
      <label for="colan-6">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-6">
      <label for="daddy-6">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-6">
      <label for="quanao-6">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-6">
      <label for="donbanhoc-6">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-6">
      <label for="sapsachvo-6">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-6">
      <label for="sapquanao-6">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-6">
      <label for="danhrang-6">Đánh răng</label>
    </div>
  </div>
</td>
</tr>

<tr data-time="17:00">
<td class="time">17:00</td>
<td data-day="1" class="red" rowspan="2" data-start="17:00" data-end="17:30">BJJ</td>
<td data-day="2" class="gray"></td>
<td data-day="3" class="gray" rowspan="3" data-start="17:00" data-end="19:00">c.Thanh</td>
<td data-day="4" class="gray"></td>
<td data-day="5" class="red" rowspan="2" data-start="17:00" data-end="17:30">BJJ</td>
</tr>

<tr data-time="17:30">
<td class="time">17:30</td>
<td data-day="2" class="blue" rowspan="3" data-start="17:30" data-end="19:20">swim</td>
<td data-day="4" class="blue" rowspan="3" data-start="17:30" data-end="19:20">swim</td>
</tr>

<tr data-time="19:00">
<td class="time">19:00</td>
<td data-day="1" class="black" rowspan="4" data-start="19:00" data-end="20:15">JKD</td>
<td data-day="5" class="black" rowspan="4" data-start="19:00" data-end="20:15">JKD</td>
</tr>

<tr data-time="19:20">
<td class="time">19:20</td>
<td data-day="3" class="black" rowspan="3" data-start="19:00" data-end="20:15">JKD</td>
</tr>

<tr data-time="19:30">
<td class="time">19:30</td>
<td data-day="2" class="gray">eat</td>
<td data-day="4" class="gray">eat</td>
</tr>

<tr data-time="20:15">
<td class="time">20:15</td>
<td data-day="2" rowspan="3" data-start="20:15" data-end="21:00">
  <div class="study-box" data-box-id="study2">
    <div class="study-item">
      <input type="checkbox" id="math-2">
      <label for="math-2">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-2">
      <label for="vietnamese-2">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-2">
      <label for="english-2">Đọc TV x3</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-2">
      <label for="cothanh-2">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-2">
      <label for="colan-2">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-2">
      <label for="daddy-2">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-2">
      <label for="quanao-2">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-2">
      <label for="donbanhoc-2">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-2">
      <label for="sapsachvo-2">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-2">
      <label for="sapquanao-2">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-2">
      <label for="danhrang-2">Đánh răng</label>
    </div>
  </div>
</td>
<td data-day="4" rowspan="3" data-start="20:15" data-end="21:00">
  <div class="study-box" data-box-id="study4">
    <div class="study-item">
      <input type="checkbox" id="math-4">
      <label for="math-4">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-4">
      <label for="vietnamese-4">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-4">
      <label for="english-4">Đọc TV x3</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-4">
      <label for="cothanh-4">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-4">
      <label for="colan-4">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-4">
      <label for="daddy-4">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-4">
      <label for="quanao-4">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-4">
      <label for="donbanhoc-4">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-4">
      <label for="sapsachvo-4">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-4">
      <label for="sapquanao-4">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-4">
      <label for="danhrang-4">Đánh răng</label>
    </div>
  </div>
</td>
</tr>

<tr data-time="20:30">
<td class="time">20:30</td>
<td data-day="1" class="gray">eat + bath</td>
<td data-day="3" class="gray">eat + bath</td>
<td data-day="5" class="gray">eat + bath</td>
</tr>

<tr data-time="21:00">
<td class="time">21:00</td>
<td data-day="1">
  <div class="study-box" data-box-id="study1">
    <div class="study-item">
      <input type="checkbox" id="math-1">
      <label for="math-1">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-1">
      <label for="vietnamese-1">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-1">
      <label for="english-1">Đọc TV x3</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-1">
      <label for="cothanh-1">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-1">
      <label for="colan-1">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-1">
      <label for="daddy-1">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-1">
      <label for="quanao-1">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-1">
      <label for="donbanhoc-1">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-1">
      <label for="sapsachvo-1">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-1">
      <label for="sapquanao-1">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-1">
      <label for="danhrang-1">Đánh răng</label>
    </div>
  </div>
</td>
<td data-day="3">
  <div class="study-box" data-box-id="study3">
    <div class="study-item">
      <input type="checkbox" id="math-3">
      <label for="math-3">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-3">
      <label for="vietnamese-3">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-3">
      <label for="english-3">Đọc TV x3</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-3">
      <label for="cothanh-3">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-3">
      <label for="colan-3">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-3">
      <label for="daddy-3">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-3">
      <label for="quanao-3">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-3">
      <label for="donbanhoc-3">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-3">
      <label for="sapsachvo-3">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-3">
      <label for="sapquanao-3">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-3">
      <label for="danhrang-3">Đánh răng</label>
    </div>
  </div>
</td>
<td data-day="5">
  <div class="study-box" data-box-id="study5">
    <div class="study-item">
      <input type="checkbox" id="math-5">
      <label for="math-5">Phiếu Toán</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="vietnamese-5">
      <label for="vietnamese-5">Phiếu TV</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="english-5">
      <label for="english-5">Đọc TV x3</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="cothanh-5">
      <label for="cothanh-5">BT c.Thanh</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="colan-5">
      <label for="colan-5">BT c.Lan</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="daddy-5">
      <label for="daddy-5">TA Daddy</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="quanao-5">
      <label for="quanao-5">Cất quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="donbanhoc-5">
      <label for="donbanhoc-5">Dọn bàn học</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapsachvo-5">
      <label for="sapsachvo-5">Sắp sách vở</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="sapquanao-5">
      <label for="sapquanao-5">Sắp quần áo</label>
    </div>

    <div class="study-item">
      <input type="checkbox" id="danhrang-5">
      <label for="danhrang-5">Đánh răng</label>
    </div>
  </div>
</td>
</tr>

<tr data-time="22:00">
<td class="time">22:00</td>
<td data-day="1" class="gray">sleep</td>
<td data-day="2" class="gray">sleep</td>
<td data-day="3" class="gray">sleep</td>
<td data-day="4" class="gray">sleep</td>
<td data-day="5" class="gray">sleep</td>
</tr>
</table>

<div style="text-align:center"><button id="newWeekBtn">Start a new week</button></div>

<script>
  function toMin(t){let[a,b]=t.split(":");return a*60+ +b}

  function isTimeBetween(now, start, end) {
    return now >= toMin(start) && now < toMin(end);
  }

  function tick(){
    const now=new Date()
    const day=now.getDay()
    const cur=now.getHours()*60+now.getMinutes()


    document.querySelectorAll(".day-highlight,.time-highlight,.blink")
      .forEach(e=>e.classList.remove("day-highlight","time-highlight","blink"))

    document.querySelector(`th[data-day="${day}"]`)?.classList.add("day-highlight")

    const rows=[...document.querySelectorAll("tr[data-time]")]
    for(let i=0;i<rows.length-1;i++){
      if(cur>=toMin(rows[i].dataset.time)&&cur<toMin(rows[i+1].dataset.time)){
        rows[i].children[0].classList.add("time-highlight")
        rows[i].querySelectorAll("td").forEach(td=>{
          if(td.dataset.day==day || td.dataset.days?.includes(day))
            td.classList.add("blink")
        })
        break
      }
    }

    document.querySelectorAll("td[rowspan]").forEach(td => {
      const start = td.dataset.start;
      const end = td.dataset.end;
      if (isTimeBetween(cur, start, end)) {
        td.classList.add("blink");
      } else {
        td.classList.remove("blink");
      }
    });
  }

  setInterval(tick,1000);tick()

  // --------------------------------
  // checkboxes handling + phao hoa tung toe chuc mung
  // --------------------------------
  const checkboxes = document.querySelectorAll('.study-box input[type="checkbox"]');
  const newWeekBtn = document.getElementById('newWeekBtn');
  const studyBoxes = document.querySelectorAll('.study-box');

  // Restore state
  studyBoxes.forEach(box => {
    const checkboxes = box.querySelectorAll('input[type="checkbox"]');

    checkboxes.forEach(cb => {
      const saved = localStorage.getItem(cb.id);
      if (saved === 'true') cb.checked = true;

      cb.addEventListener('change', () => {
        localStorage.setItem(cb.id, cb.checked);
        checkBoxCompleted(box);
      });
    });
  });

  // New Week
  newWeekBtn.addEventListener('click', () => {
    if (!confirm('Are you sure?')) return;

    studyBoxes.forEach(box => {
      const checkboxes = box.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(cb => {
        cb.checked = false;
        localStorage.setItem(cb.id, false);
      });
    });

    localStorage.removeItem('celebrated');
  });

  function checkBoxCompleted(box) {
    const checkboxes = box.querySelectorAll('input[type="checkbox"]');
    const allChecked = [...checkboxes].every(cb => cb.checked);

    const boxId = box.dataset.boxId || 'default';
    const celebratedKey = 'celebrated_' + boxId;

    if (allChecked && !localStorage.getItem(celebratedKey)) {
      launchConfetti();
      localStorage.setItem(celebratedKey, 'true');
    }

    if (!allChecked) {
      localStorage.removeItem(celebratedKey);
    }
  }

  function launchConfetti() {
    const colors = ['#ff4d4d', '#ffd633', '#4dd2ff', '#4dff88', '#d24dff'];
    const duration = 5000;
    const start = Date.now();

    const interval = setInterval(() => {
      for (let i = 0; i < 10; i++) {
        createConfetti(colors);
      }

      if (Date.now() - start > duration) {
        clearInterval(interval);
      }
    }, 200);
  }

  function createConfetti(colors) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';

    confetti.style.left = Math.random() * window.innerWidth + 'px';
    confetti.style.backgroundColor =
      colors[Math.floor(Math.random() * colors.length)];
    confetti.style.animationDuration = 2 + Math.random() * 3 + 's';

    document.body.appendChild(confetti);

    setTimeout(() => confetti.remove(), 5000);
  }

</script>
</body>
</html>

